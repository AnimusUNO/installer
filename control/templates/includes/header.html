<!--
  Sanctum Control Interface - Header Template
  Copyright (c) 2025 Mark Rizzn Hopkins

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
-->

<!-- Unified Header Template for Sanctum -->
<header class="d-flex align-items-center justify-content-between p-2 px-3 border-bottom">
    <div class="d-flex align-items-center gap-2">
        {% if request.endpoint == 'index' %}
        <!-- Agent dropdown for chat page -->
        <div class="dropdown">
            <button class="btn btn-link text-decoration-none p-0 fw-medium dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" id="agentDropdown">
                Loading...
            </button>
            <ul class="dropdown-menu" id="agentList">
                <!-- Agents will be loaded dynamically -->
            </ul>
        </div>
        
        <!-- Typing indicator -->
        <span id="typingIndicator" class="typing-indicator ms-2" style="display: none;">
            <em class="text-muted small">*is typing...*</em>
        </span>
        {% else %}
        <!-- Standard page title -->
        <span class="fw-medium">{{ page_title | default('Sanctum') }}</span>
        {% endif %}
    </div>
    <div class="d-flex align-items-center gap-3">
        <span class="text-muted small">Status: <span class="text-success">● Healthy</span> v1.0.0</span>
        
        <!-- User Info -->
        {% if session.username %}
        <div class="d-flex align-items-center gap-2">
            <span class="text-muted small">
                <i class="fas fa-user"></i> {{ session.username }} ({{ session.role }})
            </span>
            <a href="{{ url_for('logout') }}" class="btn btn-outline-danger btn-sm px-2 py-1" title="Logout">
                <i class="fas fa-sign-out-alt"></i>
                <span class="d-none d-sm-inline">Logout</span>
            </a>
        </div>
        {% endif %}
        
        <!-- Back button - only show if not on main chat page -->
        {% if request.endpoint != 'index' %}
        <a href="{{ back_url | default('/') }}" class="btn btn-outline-light btn-sm px-3 py-1">
            <span class="me-1">←</span>
            <span class="d-none d-sm-inline">{{ back_text | default('Back to Chat') }}</span>
        </a>
        {% else %}
        <!-- Settings button for chat page -->
        <a href="/settings" class="btn btn-outline-light btn-sm px-3 py-1">
            <span class="me-1">⚙</span>
            <span class="d-none d-sm-inline">Settings</span>
        </a>
        {% endif %}
    </div>
</header>
